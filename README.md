–ü—Ä–æ–µ–∫—Ç –ø–æ –¥–æ–æ–±—É—á–µ–Ω–∏—é GPT-2 (Fine-Tuning)
–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —à–∞–±–ª–æ–Ω –¥–ª—è —Ç–æ–Ω–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥–µ–ª–∏ GPT‚Äë2 –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ transformers –æ—Ç Hugging Face –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–º –∫–æ—Ä–ø—É—Å–µ —Ç–µ–∫—Å—Ç–æ–≤.
–û–Ω –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –¥–∞–Ω–Ω—ã—Ö, –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö —Ç–æ—á–µ–∫ ‚Äî –≤—Å—ë –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–æ –≤ –ø–æ–Ω—è—Ç–Ω–æ–π –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ. üöÄ

üìö –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞
–¶–µ–ª—å ‚Äî –¥–æ–æ–±—É—á–∏—Ç—å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å GPT‚Äë2 –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON Lines (my_corpus.jsonl).
–°–∫—Ä–∏–ø—Ç train.py –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ, –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—é, –æ–±—É—á–µ–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –º–æ–¥–µ–ª—å –∏ –ª–æ–≥–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.

üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
gpt2-finetune-custom/
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ my_corpus.jsonl       # –ö–∞—Å—Ç–æ–º–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSONL
‚îú‚îÄ‚îÄ train.py                  # –°–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è GPT-2
‚îú‚îÄ‚îÄ logs/                     # –õ–æ–≥–∏ –æ–±—É—á–µ–Ω–∏—è (–¥–ª—è TensorBoard)
‚îú‚îÄ‚îÄ model/                    # –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —á–µ–∫–ø–æ–π–Ω—Ç—ã –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ README.md                 # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îî‚îÄ‚îÄ requirements.txt          # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞
‚úÖ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
Python 3.8 –∏–ª–∏ –≤—ã—à–µ

–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É–∫–∞–∑–∞–Ω—ã –≤ requirements.txt

üîß –®–∞–≥–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
–ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
git clone <—Å—Å—ã–ª–∫–∞_–Ω–∞_—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π>
cd gpt2-finetune-custom
–°–æ–∑–¥–∞–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (–ø–æ –∂–µ–ª–∞–Ω–∏—é):

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
–£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
pip install -r requirements.txt
üìñ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞
–§–∞–π–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSONL (data/my_corpus.jsonl) ‚Äî –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç JSON-–æ–±—ä–µ–∫—Ç —Å –ø–æ–ª–µ–º "text":

json
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
{"text": "–ñ–∏–ª-–±—ã–ª –æ–¥–Ω–∞–∂–¥—ã –≤ –ª–µ—Å—É –º—É–¥—Ä—ã–π —Ñ–∏–ª–∏–Ω..."}
{"text": "–ü–æ—á–µ–º—É –∫—É—Ä–∏—Ü–∞ –ø–µ—Ä–µ—à–ª–∞ –¥–æ—Ä–æ–≥—É? –ß—Ç–æ–±—ã –æ–∫–∞–∑–∞—Ç—å—Å—è –ø–æ –¥—Ä—É–≥—É—é —Å—Ç–æ—Ä–æ–Ω—É!"}
üìù –£–±–µ–¥–∏—Å—å, —á—Ç–æ:

–ö–æ–¥–∏—Ä–æ–≤–∫–∞ —Ñ–∞–π–ª–∞: UTF-8

–§–∞–π–ª –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ data/

2. –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è
–ó–∞–ø—É—Å—Ç–∏ —Å–∫—Ä–∏–ø—Ç:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
python train.py
–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç:

–ó–∞–≥—Ä—É–∑–∏—Ç—Å—è –∏ —Ç–æ–∫–µ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è –¥–∞—Ç–∞—Å–µ—Ç

–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –º–æ–¥–µ–ª—å GPT-2

–ú–æ–¥–µ–ª—å –æ–±—É—á–∏—Ç—Å—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 3 —ç–ø–æ—Ö–∏)

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ model/, –ª–æ–≥–∏ ‚Äî –≤ logs/

3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±—É—á–µ–Ω–∏—è
–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π TensorBoard:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
tensorboard --logdir logs/
–û—Ç–∫—Ä–æ–π —Å—Å—ã–ª–∫—É (–æ–±—ã—á–Ω–æ http://localhost:6006), —á—Ç–æ–±—ã –Ω–∞–±–ª—é–¥–∞—Ç—å –∑–∞ –º–µ—Ç—Ä–∏–∫–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Ç–µ—Ä—è–º–∏/loss).

‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ train.py (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å):

–ü–∞—Ä–∞–º–µ—Ç—Ä	–û–ø–∏—Å–∞–Ω–∏–µ	–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
per_device_train_batch_size	–†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (GPU/CPU)	2
num_train_epochs	–ö–æ–ª-–≤–æ —ç–ø–æ—Ö –æ–±—É—á–µ–Ω–∏—è	3
save_steps	–°–æ—Ö—Ä–∞–Ω—è—Ç—å —á–µ–∫–ø–æ–π–Ω—Ç –∫–∞–∂–¥—ã–µ N —à–∞–≥–æ–≤	500
logging_steps	–ó–∞–ø–∏—Å—ã–≤–∞—Ç—å –ª–æ–≥–∏ –∫–∞–∂–¥—ã–µ N —à–∞–≥–æ–≤	100
max_length	–ú–∞–∫—Å. –¥–ª–∏–Ω–∞ —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏–∏	512
save_total_limit	–ú–∞–∫—Å–∏–º—É–º —Å–æ—Ö—Ä–∞–Ω—è–µ–º—ã—Ö —á–µ–∫–ø–æ–π–Ω—Ç–æ–≤	2

üìù –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö
–ü—Ä–∏–º–µ—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ my_corpus.jsonl:

json
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
{"text": "–°–æ–ª–Ω—Ü–µ —Å–∞–¥–∏–ª–æ—Å—å –∑–∞ —Ö–æ–ª–º—ã, –æ–∫—Ä–∞—à–∏–≤–∞—è –Ω–µ–±–æ –≤ –∞–ª—ã–µ —Ü–≤–µ—Ç–∞..."}
{"text": "–õ—é–±–æ–ø—ã—Ç–Ω–∞—è –ª–∏—Å–∞ –ø—Ä–æ–±—Ä–∞–ª–∞—Å—å —Å–∫–≤–æ–∑—å –ª–µ—Å –≤ –ø–æ–∏—Å–∫–∞—Ö –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–π."}
–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –≤ –ø–æ—Ö–æ–∂–µ–º —Å—Ç–∏–ª–µ.

‚ÑπÔ∏è –ó–∞–º–µ—Ç–∫–∏
üåê –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏ GPT‚Äë2.

‚ö° –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è GPU, –Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ –æ–±—É—á–µ–Ω–∏–µ –∏ –Ω–∞ CPU.

üìä –î–ª—è –ø–æ–ª–µ–∑–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –Ω—É–∂–Ω–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–æ–π –∫–æ—Ä–ø—É—Å (—Å–æ—Ç–Ω–∏ –∏–ª–∏ —Ç—ã—Å—è—á–∏ —Å—Ç—Ä–æ–∫).

üß™ –£–±–µ–¥–∏—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω tensorboard, –µ—Å–ª–∏ –ø–ª–∞–Ω–∏—Ä—É–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏.

üíæ save_total_limit –ø–æ–º–æ–≥–∞–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∏—Å–∫–∞.